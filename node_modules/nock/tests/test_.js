var nock = require('../');
var request = require('request');
var test    = require('tap').test;

test('works', function(t) {
  var productMock = {
    name: 'product mock'
  };

  nock('http://services-amb')
        .get('/product2/?groups=284182%2C%2C284172%2C%2C284174')
        .reply(200, productMock);

  request({
    uri: 'http://services-amb/product2/',
    qs: {'groups': '284182,,284172,,284174'}},

    function(err, res, body) {
      if (err) throw err;
      t.equal(res.statusCode, 200);
      t.end();
    });

});

